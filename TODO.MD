# TODO

1. **[BUG/RENDER] Пропадают части стен/фундамента + мерцание (flickering) поверхностей**

   **Симптомы:**
   - В viewer часть элементов (например, стенка/плоскость фундамента) не отображается, хотя в другой программе этот же IFC показывает стены корректно.
   - В зоне «пропавшей» геометрии видны поверхности за ней, которые **мигают**; визуально похоже, что поверхность то появляется, то пропадает.
   - Проблема наблюдается на обеих страницах (тестовая `index.html` и страница с `IfcViewer`).

   **Что уже сделали/исключили:**
   - В `src/viewer/Viewer.js` временно **полностью отключены секущие плоскости** (клиппинг не применяется в рендере, `setSection`/`setSectionNormalized` заблокированы, гизмосы не инициализируются). Это **не убрало** пропадание стен.

   **Гипотеза НЕ фиксируется как причина (только направление проверки):**
   - Похоже на проблему рендеринга: точность depth-buffer при больших `camera.far`, z-fighting/совпадающие плоскости, порядок отрисовки прозрачных материалов (в IFC есть `opacity < 1`), либо куллинг/двусторонность.

   **План диагностики (сначала собираем факты):**
   - Добавить временное **логирование при загрузке модели** (`TEMP_DEPTH_DEBUG`): bbox модели (size/maxDim), `camera.near/far` после фокуса, количество `material.transparent === true`, минимум/диапазон `opacity`.
   - Добавить временную **стабилизацию глубины** (`TEMP_DEPTH_STABILIZATION`):
     - выставлять `camera.near/far` относительно bbox (более узкий диапазон),
     - опционально включить `logarithmicDepthBuffer` (если подтвердится, что проблема именно в глубине).
   - После получения логов — определить, связано ли “пропадание” с прозрачностью/порядком отрисовки или с depth precision.

   **Критерий успеха:**
   - Пропавшие стены/фундамент отображаются стабильно, мерцание исчезает.
